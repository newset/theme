/*
 * ************************************************************* *
 * Name       : Power wizard                                     *
 * Date       : Feb 2013                                         *
 * Owner      : CreativeMilk                                     *
 * Url        : www.creativemilk.net                             *
 * Version    : 1.0                                              *
 * Updated    : 2014-01-19 23:17:34 UTC+02:00                    *
 * Developer  : Mark                                             *
 * Dependency :                                                  *
 * Lib        : jQuery 1.7+                                      *
 * Licence    : NOT free                                         *
 * This is part of a themeforest file                            *
 * ************************************************************* *
 */

;(function(e){if(typeof define==="function"&&define.amd){define([jquery],e)}else{e(jQuery)}})(function(e){function n(n,r){this.obj=e(n);this.o=e.extend({},e.fn[t].defaults,r);this.container=e(this.o.containerSelector);this.nextBtn=this.o.nextButtonSelector;this.prevBtn=this.o.prevButtonSelector;this.navBtn=this.o.navButtonSelector;this.aClass=this.o.activeClass;this.init()}var t="powerWizard";n.prototype={init:function(){var e=this;e.container.attr("data-powerwizard-step",e.o.startAt);e._switchStep(e.o.startAt);e._clickEvents();e._submitEvents()},_activeClass:function(){var e=this;e._currentStepVal();if(e.o.historyTitles===false){e.obj.children(":gt("+cur+")").removeClass(e.aClass)}e.obj.children(":lt("+(cur+1)+")").addClass(e.aClass);if(e.container.find(e.navBtn).length>0){e.container.find(e.navBtn).children().removeClass(e.aClass).eq(cur).addClass(e.aClass)}},_disableClass:function(t){var n=this;var r=parseInt(e(n.navBtn).children().length);if(t==0){e(n.prevBtn).addClass(n.o.disableClass)}else{e(n.prevBtn).removeClass(n.o.disableClass)}if(t==r-1){e(n.nextBtn).addClass(n.o.disableClass)}else{e(n.nextBtn).removeClass(n.o.disableClass)}},_currentStepVal:function(){var t=this;cur=parseInt(e(t.o.containerSelector).attr("data-powerwizard-step"));return cur},_clickEvents:function(){var t=this;if("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch){var n="touchstart"}else{n="click"}if(t.o.clickableTitles===true){t.obj.addClass("powerwizard-clickable").on(n," *",function(n){var r=parseInt(e(this).index());t._validation(r-1);if(validation===false){n.preventDefault();return false}t._switchStep(r);n.preventDefault()})}t.container.on(n,t.nextBtn+","+t.prevBtn,function(n){if(!e(n.target).is("."+t.o.disableClass)&&!e(n.target).parent().is("."+t.o.disableClass)){t._currentStepVal();if(e(n.target).is(t.nextBtn)||e(n.target).parent().is(t.nextBtn)){t._validation(cur);if(validation===false){n.preventDefault();return false}var r=cur+1}else{r=cur-1}t._switchStep(r)}n.preventDefault()});e(t.navBtn).on(n,">",function(n){t._currentStepVal();t._validation(cur);if(validation===false){n.preventDefault();return false}t._switchStep(e(this).index());n.preventDefault()})},_submitEvents:function(){var t=this;e(t.o.containerSelector).on("submit",function(n){function r(){if(typeof t.o.onSubmit=="function"){t.o.onSubmit.call(this,{step:currentStep,output:e(this).find("form").serialize()})}}t._validation(cur);if(validation===false){n.preventDefault();return false}t._callbackData();if(t.o.useAjax===true){var i="";var s="";if(container.is("form")){var o=container}else{o=container.find("form")}if(o.attr("method")){var u=o.attr("method")}if(o.attr("action")){var s=o.attr("action")}e.ajax({type:u,url:s,data:o.serialize(),error:function(e){if(typeof t.o.ajaxError=="function"){t.o.ajaxError.call(this,{step:currentStep})}},success:function(e){if(typeof t.o.ajaxSuccess=="function"){t.o.ajaxSuccess.call(this,{step:currentStep})}}});r();n.preventDefault()}r()})},_callbackData:function(){var e=this;e._currentStepVal();currentStep=e.container.find(e.o.stepsSelector).eq(cur);return currentStep},_validation:function(e){var t=this;validation=true;t._callbackData();if(typeof t.o.onValidate=="function"){validation=t.o.onValidate.call(this,{step:currentStep})}return validation},_switchStep:function(e){var t=this;t._currentStepVal();t.container.find(t.o.stepsSelector).hide().eq(e).show();if(e!=cur){t._callbackData();if(typeof t.o.onSwitch=="function"){t.o.onSwitch.call(this,{step:currentStep})}if(e>cur){if(typeof t.o.onNext=="function"){t.o.onNext.call(this,{step:currentStep})}}else{if(typeof t.o.onPrev=="function"){t.o.onPrev.call(this,{step:currentStep})}}}t.container.attr("data-powerwizard-step",e);t._activeClass();t._disableClass(cur)},update:function(e){var t=this},destroy:function(t){e.removeData(this.obj,this.pluginName)}};e.fn[t]=function(r,i){return this.each(function(){var s=e(this);var o=s.data(t);var u=typeof r=="object"&&r;if(!o){s.data(t,o=new n(this,u))}if(typeof r=="string"){o[r](i)}})};e.fn[t].defaults={containerSelector:".powerwizard-content",stepsSelector:".powerwizard-step",nextButtonSelector:".pw-next",prevButtonSelector:".pw-prev",navButtonSelector:".pw-nav",activeClass:"pw-active",disableClass:"pw-disable",clickableTitles:true,historyTitles:false,startAt:0,useAjax:true,onNext:function(){},onPrev:function(){},onSwitch:function(){},onSubmit:function(){},ajaxSuccess:function(){},ajaxError:function(){},onValidate:function(e){}}})